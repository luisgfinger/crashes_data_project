@startuml
title Crashes Data Project - Component Diagram

package "Entry Point" {
  [run.py] as run
}

package "Pipelines" {
  [silver_v1.py\n(vehicles)] as silver_vehicles
}

package "Config" {
  [config.py] as config
}

package "Utils" {
  [io_utils.py] as io
}

package "DQ (Rules)" {
  [dq.py\n(silver/vehicles/v1)] as dq_vehicles
}

package "Metrics" {
  [metrics.py] as metrics_mod
}

package "Data (Artifacts)" {
  [Bronze Data\n(CSV Files)] as bronze
  [Silver Vehicles Parquet\n(partitioned by run_date)] as silver_data
  [Silver Quarantine Vehicles\n(per run_date folder)] as quarantine
  [Metrics CSV\n(per run_date folder)] as metrics_out
}

run --> silver_vehicles : calls main()
silver_vehicles --> config : reads paths/settings
silver_vehicles --> io : find/read/write helpers
silver_vehicles --> dq_vehicles : applies DQ rules
silver_vehicles --> metrics_mod : writes metrics.csv

bronze --> silver_vehicles : input
silver_vehicles --> silver_data : output (clean)
silver_vehicles --> quarantine : output (quarantine)
silver_vehicles --> metrics_out : output (metrics)

@enduml